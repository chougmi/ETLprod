<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>synthese_ms</name>
    <description />
    <extended_description />
    <trans_version />
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection />
        <schema />
        <table />
        <size_limit_lines />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject />
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject />
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject />
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject />
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection />
        <schema />
        <table />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection />
      <table />
      <field />
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file />
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2018/07/18 13:20:44.343</created_date>
    <modified_user>-</modified_user>
    <modified_date>2018/07/23 22:36:28.642</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>bi</name>
    <server>51.38.62.93</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>bi</database>
    <port>14332</port>
    <username>bi</username>
    <password>Encrypted 2f5c9d9ae53dda6a1ff00af5dd8abf6f4</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>14332</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Prod</name>
    <server>cashplusmaster.cpkuecwscz72.eu-central-1.rds.amazonaws.com</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>CASH_PLUS</database>
    <port>1433</port>
    <username>dwroot</username>
    <password>Encrypted 2be98afc86aa7a285ac3fa922fea9bffe</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Table input</from>
      <to>Table output</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Table input</name>
    <type>TableInput</type>
    <description />
    <distribute>N</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>Prod</connection>
    <sql>select 'Cashplus' as 'Company' , day(dateadd(day,datediff(day,1,GETDATE()),0)) as 'Date',

 (select  sum(nfinished)   
from diary_transaction t left join shop s on t.nshopid = s.nid where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) 
and nproductid = 5 and len(sshopid) >4) as 'WU NB' , 

(select   sum(namountfinished) 
from diary_transaction t left join shop s on t.nshopid = s.nid where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) 
and nproductid = 5 and len(sshopid) >4)as 'WU AMT MAd'  , 
'      ' as 'Gain Change' ,
'      ' as 'TOT dtrs  Dhs' ,
0 as 'WU AMT DEV' , 
0                           as 'WU Com Dev' ,
0  							as 'WU GDC Dev ' , 
'      ' as 'Total USD' ,
'      ' as 'Taux Cession' ,
'      ' as 'Swift DHs',
'      ' as 'Comm DHs' ,


(select  sum(nfinished)   
from diary_transaction t left join shop s on t.nshopid = s.nid where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) 
and nproductid = 5 and len(sshopid) =4) as 'WU NB' , 

(select   sum(namountfinished) 
from diary_transaction t left join shop s on t.nshopid = s.nid where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) 
and nproductid = 5 and len(sshopid) =4)as 'WU AMT MAd' ,
'      ' as 'Gain Change' ,
'      ' as 'TOT dtrs  Dhs' ,
0 as 'WU AMT DEV' , 
0 as 'WU Com Dev' ,
0 as 'WU GDC Dev ' , 
'     ' as 'Total USD' ,
'     ' as 'Taux Cession' ,
'     ' as 'Swift DHs',
'     ' as 'Comm DHs' ,



 
(select  sum(nfinished)   
from diary_transaction t left join shop s on t.nshopid = s.nid where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) 
and nproductid = 6 and len(sshopid) >4) as 'MG Nb',

(select   sum(namountfinished) 
from diary_transaction t left join shop s on t.nshopid = s.nid where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) 
and nproductid = 6 and len(sshopid) >4) as 'MG Amt MAD' ,
'  ' as 'Gain de change' ,
'  ' as 'MG Amt DEV' ,
'  ' as 'GDC Dev mg' ,
'  ' 							as 'MG Com DEV' ,
'  ' as 'Swift Dhs' ,
'  ' as 'Comm Dhs' , 
0 as 'MG Nb',
0 as 'MG Amt MAD' ,
'  ' as 'Gain de change' ,
0 as 'MG Amt DEV' ,
0 as 'GDC Dev mg' ,
0 as 'MG Com DEV' ,
'   ' as 'Swift Dhs' ,
'   ' as 'Comm Dhs' , 
'   ' as 'Exchange  Rate MT' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 25) as 'MT nb',

(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 25) as 'MT AMt MAd' , 
'    ' as 'MT Dev' ,
'    ' as 'Gain de Change' ,
'    ' 							as 'MT Comm Dev' ,

'     ' as 'Total Euro Recu' ,
'     ' as 'Cours de cession' ,
'     ' as 'Contre valeur euro recu' ,
'     ' as 'Remboursement principal' ,
'     ' as 'Commission en Dh',

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 23) as 'ME nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 23) as 'ME AMt MAd' , 
'     ' as 'Total Mad recu',
'     ' as 'Remboursement principal' ,
'     ' as 'ME Comm MAd' ,

'     ' as 'Rate Ria' ,
(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 22)  as 'RIA nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 22) as 'RIA AMt MAd' , 
'     ' as 'Mnt Euro' ,
'     ' as 'Gain de Change' ,
'     ' as 'Commisson Euro' ,
'     ' as 'principal Euro' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Total Euro Recu' ,
(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 54)  as 'MI nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 54)as 'MI AMt MAd' , 
'     ' as 'Total Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs ' ,
'     ' as 'Commission En Dhs' ,

(select sum(nNumber1) from diary_ChangeDevise left join shop on shop.nid = diary_ChangeDevise.nShopId where
 cast(dDiaryDate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and len(sshopid) > 4) as 'CHA nb CP',
(select sum(nContreValeurAmount1) from diary_ChangeDevise left join shop on shop.nid = diary_ChangeDevise.nShopId where
 cast(dDiaryDate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and len(sshopid) > 4) as 'CHA AMt MAd CP'  ,
'     ' as 'Commission Achat et vente ' ,
(select sum(nNumber1) from diary_ChangeDevise left join shop on shop.nid = diary_ChangeDevise.nShopId where
 cast(dDiaryDate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and len(sshopid) = 4)  as 'CHA nb EuroSol',
(select sum(nContreValeurAmount1) from diary_ChangeDevise left join shop on shop.nid = diary_ChangeDevise.nShopId where
 cast(dDiaryDate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and len(sshopid) = 4)  as 'CHA AMt MAd EuroSol' ,
'     ' as 'Commission Vente banque' ,
'     ' as 'Commission   Vente Client' ,


(select count(*) from transactions t left join shop s on t.nshopid = s.nid where cast(t.dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 1 
and len(sshopid) >=4 and len(sshopid) &lt;=6 and t.nTransactionStatusId in ( 8 , 26) ) as 'CPIN nb',
(select sum(namount) from transactions t left join shop s on t.nshopid = s.nid where cast(t.dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 1 
and len(sshopid) >=4 and len(sshopid) &lt;=6 and t.nTransactionStatusId in ( 8 , 26) ) as  'CPIN AMt MAd' , 




(select count(*) from transactions t left join shop s on t.nshopid = s.nid where cast(t.dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 19
and len(sshopid) >=4 and len(sshopid) &lt;= 6 and t.nTransactionStatusId = 8 ) as 'CPOUT nb',

(select sum(namount) from transactions t left join shop s on t.nshopid = s.nid where cast(t.dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 19
and len(sshopid) >=4 and len(sshopid) &lt;=6 and t.nTransactionStatusId = 8 )as  'CPOUT AMt MAd' , 

(select sum(nOperationFee) from transactions t left join shop s on t.nshopid = s.nid where cast(t.dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 1 
and len(sshopid) >=4 and len(sshopid) &lt;=6 and t.nTransactionStatusId in ( 8 , 26) )as  'Com AMt MAd'  ,

(select count(*) from transactions t left join shop s on t.nshopid = s.nid where cast(t.dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 1 
and len(sshopid) >=4 and len(sshopid) &lt;=6 and t.nTransactionStatusId in ( 8 , 26) and nServiceFee = 3)as  'NBR SMS' ,

(select sum(nServiceFee) from transactions t left join shop s on t.nshopid = s.nid where cast(t.dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 1 
and len(sshopid) >=4 and len(sshopid) &lt;=6 and t.nTransactionStatusId in ( 8 , 26))as  'AMt MAd SMS' ,



(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 28) as 'MEP nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 28) as 'MEP AMt MAd' , 
'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 30) as 'SW nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 30)as 'SW AMt MAd' ,

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,


(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 29) as 'WARI nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 29)as 'WARI AMt MAd'  ,
'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession' ,
'     ' as 'Contre valeur En DHs' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 31)  as 'MONTY nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 31) as 'MONTY AMt MAd' ,
'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 39)  as 'BLM nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 39)as 'BLM AMt MAd' ,

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 44)  as 'Titanes nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 44) as 'Titanes AMt MAd' ,

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 50)  as 'Pintail nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 50) as 'Pintail AMt MAd' ,

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 47)  as 'FE&amp;Ze nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 47) as 'FE&amp;ZE AMt MAd' ,
'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 42)  as 'EuroPhil nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 42) as 'EuroPhil AMt MAd' , 

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,


(select  count(*) from PayExpress_Advice where sBillerId = 1010
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'RADEEMA nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1010
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'RADEEMA Amt Mad' ,
'     ' as 'Comm' ,
 

(select  count(*) from PayExpress_Advice where sBillerId = 1015
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) )as 'RAMSA nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1015
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'RAMSA Amt Mad'  ,

'     ' as 'Comm'  ,
(select  sum(nOperations) from diary_ALM where nComissionProductId = 37
and cast(dDiaryDate as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'pay Express nb',
(select  sum(nAmount) from diary_ALM where nComissionProductId = 37
and cast(dDiaryDate as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'pay Express AMt MAd' ,
'     ' as 'pay Express COM MAd'  ,

(select  count(*) from PayExpress_Advice where sBillerId = 1022
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'VIGNETTE nb',
(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1022
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) )  as 'VIGNETTE AMt MAd',

'     ' as 'Comm',

(select  count(*) from recharge where 
cast(dRecharge as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'RT nb',
(select  sum(namount) from recharge where 
cast(dRecharge as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'RT AMt MAd' ,
'     ' as 'Comm' ,

(select  count(*) from PayExpress_Advice where sBillerId = 1006
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'TGR nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1006
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'TGR Amt Mad' ,
'     ' as 'Comm' ,
(select  count(*) from PayExpress_Advice where sBillerId = 1005
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'Lydec nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1005
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'Lydec Amt Mad' ,

'     ' as 'Comm' ,
(select  count(*) from PayExpress_Advice where sBillerId = 1018
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'Inwi Facture nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1018
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'Inwi Facture AMT Mad' ,
'     ' as 'Comm' ,
(select  count(*) from PayExpress_Advice where sBillerId = 1009
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'AMN Tetouan nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1009
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as ' AMN Tetouan Amt Mad' ,
'     ' as 'Comm' ,
(select  count(*) from PayExpress_Advice where sBillerId = 1008
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'AMN Tanger nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1008
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as ' AMN Tanger Amt Mad' ,

'     ' as 'Comm' ,

(select  count(*) from PayExpress_Advice where sBillerId = 1007
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'REDAL nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1007
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'REDAL Amt Mad' ,
'     ' as 'Comm' ,
(select  count(*) from PayExpress_Advice where sBillerId = 1025
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'DGI nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1025
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'DGI Amt Mad' ,
'     ' as 'Comm' ,
(select  count(*) from PayExpress_Advice where sBillerId = 1016
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'RAK nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1016
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'RAK Amt Mad' ,

'     ' as 'Comm'  ,

(select  count(*) from PayExpress_Advice where sBillerId = 1014
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'RADEEF nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1014
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'RADEEF Amt Mad' ,


'     ' as 'Comm'   ,
(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 48) as 'XPR nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 48) as 'XPR AMt MAd' ,

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,

(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 40) as 'VLT nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 40) as 'VLT AMt MAd' ,

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm' ,

(select  count(*) from CTM_transactions where 
cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'CTM nb',
(select  sum(nTotalPaid) from CTM_transactions where 
cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'CTM AMt MAd' ,
'     ' as 'Comm' ,


(select  count(*) from PayExpress_Advice where sBillerId = 1039
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'ONEE-BE nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1039
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'ONEE-BE Amt Mad' ,


'     ' as 'Comm'  ,
(select sum(nfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 51)  as 'i-tr nb',
(select sum(namountfinished) from diary_transaction t where cast(t.ddiarydate as date) = dateadd(day,datediff(day,1,GETDATE()),0) and nproductid = 51) as 'i-tr AMt MAd' ,

'     ' as 'Montant Euro Recu' ,
'     ' as 'Cours de cession ' ,
'     ' as 'Contre valeur En DHs '  ,
'     ' as 'Comm'  , 

(select  count(*) from PayExpress_Advice where sBillerId = 1043
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'RADEETA nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1043
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)  ) as 'RADEETA Amt Mad' ,

(select  count(*) from PayExpress_Advice where sBillerId = 1040
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'RADEEL nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1040
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0)) as 'RADEEL Amt Mad' ,


(select  count(*) from PayExpress_Advice where sBillerId = 1023
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'AIR ARABIA nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1023
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'AIR ARABIA Amt Mad' ,

(select  count(*) from PayExpress_Advice where sBillerId = 1004
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'Orange Facture nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1004
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'Orange Facture Amt Mad' ,

(select  count(*) from PayExpress_Advice where sBillerId = 1030
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'ANCFCC nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1030
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'ANCFCC Amt Mad' ,


(select  count(*) from PayExpress_Advice where sBillerId = 1056
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'E-Timbre nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1056
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'E-Timbre Amt Mad' ,

(select  count(*) from PayExpress_Advice where sBillerId = 1002
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'Maroc Télécom  nb' ,

(select  sum(nBillingAmount) from PayExpress_Advice where sBillerId = 1002
and cast(dinsertion as date) = dateadd(day,datediff(day,1,GETDATE()),0) ) as 'Maroc Télécom Amt Mad'
 ,  dateadd(day,datediff(day,1,GETDATE()),0) as 'full_Date'
</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>261</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table output</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>bi</connection>
    <schema />
    <table>synthese</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>Company</column_name>
        <stream_name>Company</stream_name>
      </field>
      <field>
        <column_name>Date</column_name>
        <stream_name>Date</stream_name>
      </field>
      <field>
        <column_name>WU NB</column_name>
        <stream_name>WU NB</stream_name>
      </field>
      <field>
        <column_name>WU AMT MAd</column_name>
        <stream_name>WU AMT MAd</stream_name>
      </field>
      <field>
        <column_name>Gain Change</column_name>
        <stream_name>Gain Change</stream_name>
      </field>
      <field>
        <column_name>TOT dtrs  Dhs</column_name>
        <stream_name>TOT dtrs  Dhs</stream_name>
      </field>
      <field>
        <column_name>WU AMT DEV</column_name>
        <stream_name>WU AMT DEV</stream_name>
      </field>
      <field>
        <column_name>WU Com Dev</column_name>
        <stream_name>WU Com Dev</stream_name>
      </field>
      <field>
        <column_name>WU GDC Dev </column_name>
        <stream_name>WU GDC Dev </stream_name>
      </field>
      <field>
        <column_name>Total USD</column_name>
        <stream_name>Total USD</stream_name>
      </field>
      <field>
        <column_name>Taux Cession</column_name>
        <stream_name>Taux Cession</stream_name>
      </field>
      <field>
        <column_name>Swift DHs</column_name>
        <stream_name>Swift DHs</stream_name>
      </field>
      <field>
        <column_name>Comm DHs</column_name>
        <stream_name>Comm DHs</stream_name>
      </field>
      <field>
        <column_name>WU NB_1</column_name>
        <stream_name>WU NB_1</stream_name>
      </field>
      <field>
        <column_name>WU AMT MAd_1</column_name>
        <stream_name>WU AMT MAd_1</stream_name>
      </field>
      <field>
        <column_name>Gain Change_1</column_name>
        <stream_name>Gain Change_1</stream_name>
      </field>
      <field>
        <column_name>TOT dtrs  Dhs_1</column_name>
        <stream_name>TOT dtrs  Dhs_1</stream_name>
      </field>
      <field>
        <column_name>WU AMT DEV_1</column_name>
        <stream_name>WU AMT DEV_1</stream_name>
      </field>
      <field>
        <column_name>WU Com Dev_1</column_name>
        <stream_name>WU Com Dev_1</stream_name>
      </field>
      <field>
        <column_name>WU GDC Dev _1</column_name>
        <stream_name>WU GDC Dev _1</stream_name>
      </field>
      <field>
        <column_name>Total USD_1</column_name>
        <stream_name>Total USD_1</stream_name>
      </field>
      <field>
        <column_name>Taux Cession_1</column_name>
        <stream_name>Taux Cession_1</stream_name>
      </field>
      <field>
        <column_name>Swift DHs_1</column_name>
        <stream_name>Swift DHs_1</stream_name>
      </field>
      <field>
        <column_name>Comm DHs_1</column_name>
        <stream_name>Comm DHs_1</stream_name>
      </field>
      <field>
        <column_name>MG Nb</column_name>
        <stream_name>MG Nb</stream_name>
      </field>
      <field>
        <column_name>MG Amt MAD</column_name>
        <stream_name>MG Amt MAD</stream_name>
      </field>
      <field>
        <column_name>Gain de change</column_name>
        <stream_name>Gain de change</stream_name>
      </field>
      <field>
        <column_name>MG Amt DEV</column_name>
        <stream_name>MG Amt DEV</stream_name>
      </field>
      <field>
        <column_name>GDC Dev mg</column_name>
        <stream_name>GDC Dev mg</stream_name>
      </field>
      <field>
        <column_name>MG Com DEV</column_name>
        <stream_name>MG Com DEV</stream_name>
      </field>
      <field>
        <column_name>Swift Dhs_2</column_name>
        <stream_name>Swift Dhs_2</stream_name>
      </field>
      <field>
        <column_name>Comm Dhs_2</column_name>
        <stream_name>Comm Dhs_2</stream_name>
      </field>
      <field>
        <column_name>MG Nb_1</column_name>
        <stream_name>MG Nb_1</stream_name>
      </field>
      <field>
        <column_name>MG Amt MAD_1</column_name>
        <stream_name>MG Amt MAD_1</stream_name>
      </field>
      <field>
        <column_name>Gain de change_1</column_name>
        <stream_name>Gain de change_1</stream_name>
      </field>
      <field>
        <column_name>MG Amt DEV_1</column_name>
        <stream_name>MG Amt DEV_1</stream_name>
      </field>
      <field>
        <column_name>GDC Dev mg_1</column_name>
        <stream_name>GDC Dev mg_1</stream_name>
      </field>
      <field>
        <column_name>MG Com DEV_1</column_name>
        <stream_name>MG Com DEV_1</stream_name>
      </field>
      <field>
        <column_name>Swift Dhs_3</column_name>
        <stream_name>Swift Dhs_3</stream_name>
      </field>
      <field>
        <column_name>Comm Dhs_3</column_name>
        <stream_name>Comm Dhs_3</stream_name>
      </field>
      <field>
        <column_name>Exchange  Rate MT</column_name>
        <stream_name>Exchange  Rate MT</stream_name>
      </field>
      <field>
        <column_name>MT nb</column_name>
        <stream_name>MT nb</stream_name>
      </field>
      <field>
        <column_name>MT AMt MAd</column_name>
        <stream_name>MT AMt MAd</stream_name>
      </field>
      <field>
        <column_name>MT Dev</column_name>
        <stream_name>MT Dev</stream_name>
      </field>
      <field>
        <column_name>Gain de Change_2</column_name>
        <stream_name>Gain de Change_2</stream_name>
      </field>
      <field>
        <column_name>MT Comm Dev</column_name>
        <stream_name>MT Comm Dev</stream_name>
      </field>
      <field>
        <column_name>Total Euro Recu</column_name>
        <stream_name>Total Euro Recu</stream_name>
      </field>
      <field>
        <column_name>Cours de cession</column_name>
        <stream_name>Cours de cession</stream_name>
      </field>
      <field>
        <column_name>Contre valeur euro recu</column_name>
        <stream_name>Contre valeur euro recu</stream_name>
      </field>
      <field>
        <column_name>Remboursement principal</column_name>
        <stream_name>Remboursement principal</stream_name>
      </field>
      <field>
        <column_name>Commission en Dh</column_name>
        <stream_name>Commission en Dh</stream_name>
      </field>
      <field>
        <column_name>ME nb</column_name>
        <stream_name>ME nb</stream_name>
      </field>
      <field>
        <column_name>ME AMt MAd</column_name>
        <stream_name>ME AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Total Mad recu</column_name>
        <stream_name>Total Mad recu</stream_name>
      </field>
      <field>
        <column_name>Remboursement principal_1</column_name>
        <stream_name>Remboursement principal_1</stream_name>
      </field>
      <field>
        <column_name>ME Comm MAd</column_name>
        <stream_name>ME Comm MAd</stream_name>
      </field>
      <field>
        <column_name>Rate Ria</column_name>
        <stream_name>Rate Ria</stream_name>
      </field>
      <field>
        <column_name>RIA nb</column_name>
        <stream_name>RIA nb</stream_name>
      </field>
      <field>
        <column_name>RIA AMt MAd</column_name>
        <stream_name>RIA AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Mnt Euro</column_name>
        <stream_name>Mnt Euro</stream_name>
      </field>
      <field>
        <column_name>Gain de Change_3</column_name>
        <stream_name>Gain de Change_3</stream_name>
      </field>
      <field>
        <column_name>Commisson Euro</column_name>
        <stream_name>Commisson Euro</stream_name>
      </field>
      <field>
        <column_name>principal Euro</column_name>
        <stream_name>principal Euro</stream_name>
      </field>
      <field>
        <column_name>Total Euro Recu_1</column_name>
        <stream_name>Total Euro Recu_1</stream_name>
      </field>
      <field>
        <column_name>MI nb</column_name>
        <stream_name>MI nb</stream_name>
      </field>
      <field>
        <column_name>MI AMt MAd</column_name>
        <stream_name>MI AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Total Euro Recu_2</column_name>
        <stream_name>Total Euro Recu_2</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _1</column_name>
        <stream_name>Cours de cession _1</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs </column_name>
        <stream_name>Contre valeur En DHs </stream_name>
      </field>
      <field>
        <column_name>Commission En Dhs</column_name>
        <stream_name>Commission En Dhs</stream_name>
      </field>
      <field>
        <column_name>CHA nb CP</column_name>
        <stream_name>CHA nb CP</stream_name>
      </field>
      <field>
        <column_name>CHA AMt MAd CP</column_name>
        <stream_name>CHA AMt MAd CP</stream_name>
      </field>
      <field>
        <column_name>Commission Achat et vente </column_name>
        <stream_name>Commission Achat et vente </stream_name>
      </field>
      <field>
        <column_name>CHA nb EuroSol</column_name>
        <stream_name>CHA nb EuroSol</stream_name>
      </field>
      <field>
        <column_name>CHA AMt MAd EuroSol</column_name>
        <stream_name>CHA AMt MAd EuroSol</stream_name>
      </field>
      <field>
        <column_name>Commission Vente banque</column_name>
        <stream_name>Commission Vente banque</stream_name>
      </field>
      <field>
        <column_name>Commission   Vente Client</column_name>
        <stream_name>Commission   Vente Client</stream_name>
      </field>
      <field>
        <column_name>CPIN nb</column_name>
        <stream_name>CPIN nb</stream_name>
      </field>
      <field>
        <column_name>CPIN AMt MAd</column_name>
        <stream_name>CPIN AMt MAd</stream_name>
      </field>
      <field>
        <column_name>CPOUT nb</column_name>
        <stream_name>CPOUT nb</stream_name>
      </field>
      <field>
        <column_name>CPOUT AMt MAd</column_name>
        <stream_name>CPOUT AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Com AMt MAd</column_name>
        <stream_name>Com AMt MAd</stream_name>
      </field>
      <field>
        <column_name>NBR SMS</column_name>
        <stream_name>NBR SMS</stream_name>
      </field>
      <field>
        <column_name>AMt MAd SMS</column_name>
        <stream_name>AMt MAd SMS</stream_name>
      </field>
      <field>
        <column_name>MEP nb</column_name>
        <stream_name>MEP nb</stream_name>
      </field>
      <field>
        <column_name>MEP AMt MAd</column_name>
        <stream_name>MEP AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu</column_name>
        <stream_name>Montant Euro Recu</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _2</column_name>
        <stream_name>Cours de cession _2</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _1</column_name>
        <stream_name>Contre valeur En DHs _1</stream_name>
      </field>
      <field>
        <column_name>SW nb</column_name>
        <stream_name>SW nb</stream_name>
      </field>
      <field>
        <column_name>SW AMt MAd</column_name>
        <stream_name>SW AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_1</column_name>
        <stream_name>Montant Euro Recu_1</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _3</column_name>
        <stream_name>Cours de cession _3</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _2</column_name>
        <stream_name>Contre valeur En DHs _2</stream_name>
      </field>
      <field>
        <column_name>Comm</column_name>
        <stream_name>Comm</stream_name>
      </field>
      <field>
        <column_name>WARI nb</column_name>
        <stream_name>WARI nb</stream_name>
      </field>
      <field>
        <column_name>WARI AMt MAd</column_name>
        <stream_name>WARI AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_2</column_name>
        <stream_name>Montant Euro Recu_2</stream_name>
      </field>
      <field>
        <column_name>MONTY nb</column_name>
        <stream_name>MONTY nb</stream_name>
      </field>
      <field>
        <column_name>MONTY AMt MAd</column_name>
        <stream_name>MONTY AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_3</column_name>
        <stream_name>Montant Euro Recu_3</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _4</column_name>
        <stream_name>Cours de cession _4</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _3</column_name>
        <stream_name>Contre valeur En DHs _3</stream_name>
      </field>
      <field>
        <column_name>Comm_1</column_name>
        <stream_name>Comm_1</stream_name>
      </field>
      <field>
        <column_name>BLM nb</column_name>
        <stream_name>BLM nb</stream_name>
      </field>
      <field>
        <column_name>BLM AMt MAd</column_name>
        <stream_name>BLM AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_4</column_name>
        <stream_name>Montant Euro Recu_4</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _5</column_name>
        <stream_name>Cours de cession _5</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _4</column_name>
        <stream_name>Contre valeur En DHs _4</stream_name>
      </field>
      <field>
        <column_name>Comm_2</column_name>
        <stream_name>Comm_2</stream_name>
      </field>
      <field>
        <column_name>Titanes nb</column_name>
        <stream_name>Titanes nb</stream_name>
      </field>
      <field>
        <column_name>Titanes AMt MAd</column_name>
        <stream_name>Titanes AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_5</column_name>
        <stream_name>Montant Euro Recu_5</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _6</column_name>
        <stream_name>Cours de cession _6</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _5</column_name>
        <stream_name>Contre valeur En DHs _5</stream_name>
      </field>
      <field>
        <column_name>Comm_3</column_name>
        <stream_name>Comm_3</stream_name>
      </field>
      <field>
        <column_name>Pintail nb</column_name>
        <stream_name>Pintail nb</stream_name>
      </field>
      <field>
        <column_name>Pintail AMt MAd</column_name>
        <stream_name>Pintail AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_6</column_name>
        <stream_name>Montant Euro Recu_6</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _7</column_name>
        <stream_name>Cours de cession _7</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _6</column_name>
        <stream_name>Contre valeur En DHs _6</stream_name>
      </field>
      <field>
        <column_name>Comm_4</column_name>
        <stream_name>Comm_4</stream_name>
      </field>
      <field>
        <column_name>FE&amp;Ze nb</column_name>
        <stream_name>FE&amp;Ze nb</stream_name>
      </field>
      <field>
        <column_name>FE&amp;ZE AMt MAd</column_name>
        <stream_name>FE&amp;ZE AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_7</column_name>
        <stream_name>Montant Euro Recu_7</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _8</column_name>
        <stream_name>Cours de cession _8</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _7</column_name>
        <stream_name>Contre valeur En DHs _7</stream_name>
      </field>
      <field>
        <column_name>Comm_5</column_name>
        <stream_name>Comm_5</stream_name>
      </field>
      <field>
        <column_name>EuroPhil nb</column_name>
        <stream_name>EuroPhil nb</stream_name>
      </field>
      <field>
        <column_name>EuroPhil AMt MAd</column_name>
        <stream_name>EuroPhil AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_8</column_name>
        <stream_name>Montant Euro Recu_8</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _9</column_name>
        <stream_name>Cours de cession _9</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _8</column_name>
        <stream_name>Contre valeur En DHs _8</stream_name>
      </field>
      <field>
        <column_name>Comm_6</column_name>
        <stream_name>Comm_6</stream_name>
      </field>
      <field>
        <column_name>RADEEMA nb</column_name>
        <stream_name>RADEEMA nb</stream_name>
      </field>
      <field>
        <column_name>RADEEMA Amt Mad</column_name>
        <stream_name>RADEEMA Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_7</column_name>
        <stream_name>Comm_7</stream_name>
      </field>
      <field>
        <column_name>RAMSA nb</column_name>
        <stream_name>RAMSA nb</stream_name>
      </field>
      <field>
        <column_name>RAMSA Amt Mad</column_name>
        <stream_name>RAMSA Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_8</column_name>
        <stream_name>Comm_8</stream_name>
      </field>
      <field>
        <column_name>pay Express nb</column_name>
        <stream_name>pay Express nb</stream_name>
      </field>
      <field>
        <column_name>pay Express AMt MAd</column_name>
        <stream_name>pay Express AMt MAd</stream_name>
      </field>
      <field>
        <column_name>pay Express COM MAd</column_name>
        <stream_name>pay Express COM MAd</stream_name>
      </field>
      <field>
        <column_name>VIGNETTE nb</column_name>
        <stream_name>VIGNETTE nb</stream_name>
      </field>
      <field>
        <column_name>VIGNETTE AMt MAd</column_name>
        <stream_name>VIGNETTE AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Comm_9</column_name>
        <stream_name>Comm_9</stream_name>
      </field>
      <field>
        <column_name>RT nb</column_name>
        <stream_name>RT nb</stream_name>
      </field>
      <field>
        <column_name>RT AMt MAd</column_name>
        <stream_name>RT AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Comm_10</column_name>
        <stream_name>Comm_10</stream_name>
      </field>
      <field>
        <column_name>TGR nb</column_name>
        <stream_name>TGR nb</stream_name>
      </field>
      <field>
        <column_name>TGR Amt Mad</column_name>
        <stream_name>TGR Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_11</column_name>
        <stream_name>Comm_11</stream_name>
      </field>
      <field>
        <column_name>Lydec nb</column_name>
        <stream_name>Lydec nb</stream_name>
      </field>
      <field>
        <column_name>Lydec Amt Mad</column_name>
        <stream_name>Lydec Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_12</column_name>
        <stream_name>Comm_12</stream_name>
      </field>
      <field>
        <column_name>Inwi Facture nb</column_name>
        <stream_name>Inwi Facture nb</stream_name>
      </field>
      <field>
        <column_name>Inwi Facture AMT Mad</column_name>
        <stream_name>Inwi Facture AMT Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_13</column_name>
        <stream_name>Comm_13</stream_name>
      </field>
      <field>
        <column_name>AMN Tetouan nb</column_name>
        <stream_name>AMN Tetouan nb</stream_name>
      </field>
      <field>
        <column_name>Comm_14</column_name>
        <stream_name>Comm_14</stream_name>
      </field>
      <field>
        <column_name>AMN Tanger nb</column_name>
        <stream_name>AMN Tanger nb</stream_name>
      </field>
      <field>
        <column_name>Comm_15</column_name>
        <stream_name>Comm_15</stream_name>
      </field>
      <field>
        <column_name>REDAL nb</column_name>
        <stream_name>REDAL nb</stream_name>
      </field>
      <field>
        <column_name>REDAL Amt Mad</column_name>
        <stream_name>REDAL Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_16</column_name>
        <stream_name>Comm_16</stream_name>
      </field>
      <field>
        <column_name>DGI nb</column_name>
        <stream_name>DGI nb</stream_name>
      </field>
      <field>
        <column_name>DGI Amt Mad</column_name>
        <stream_name>DGI Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_17</column_name>
        <stream_name>Comm_17</stream_name>
      </field>
      <field>
        <column_name>RAK nb</column_name>
        <stream_name>RAK nb</stream_name>
      </field>
      <field>
        <column_name>RAK Amt Mad</column_name>
        <stream_name>RAK Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_18</column_name>
        <stream_name>Comm_18</stream_name>
      </field>
      <field>
        <column_name>RADEEF nb</column_name>
        <stream_name>RADEEF nb</stream_name>
      </field>
      <field>
        <column_name>RADEEF Amt Mad</column_name>
        <stream_name>RADEEF Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_19</column_name>
        <stream_name>Comm_19</stream_name>
      </field>
      <field>
        <column_name>XPR nb</column_name>
        <stream_name>XPR nb</stream_name>
      </field>
      <field>
        <column_name>XPR AMt MAd</column_name>
        <stream_name>XPR AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_9</column_name>
        <stream_name>Montant Euro Recu_9</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _10</column_name>
        <stream_name>Cours de cession _10</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _9</column_name>
        <stream_name>Contre valeur En DHs _9</stream_name>
      </field>
      <field>
        <column_name>Comm_20</column_name>
        <stream_name>Comm_20</stream_name>
      </field>
      <field>
        <column_name>VLT nb</column_name>
        <stream_name>VLT nb</stream_name>
      </field>
      <field>
        <column_name>VLT AMt MAd</column_name>
        <stream_name>VLT AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_10</column_name>
        <stream_name>Montant Euro Recu_10</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _11</column_name>
        <stream_name>Cours de cession _11</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _10</column_name>
        <stream_name>Contre valeur En DHs _10</stream_name>
      </field>
      <field>
        <column_name>Comm_21</column_name>
        <stream_name>Comm_21</stream_name>
      </field>
      <field>
        <column_name>CTM nb</column_name>
        <stream_name>CTM nb</stream_name>
      </field>
      <field>
        <column_name>CTM AMt MAd</column_name>
        <stream_name>CTM AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Comm_22</column_name>
        <stream_name>Comm_22</stream_name>
      </field>
      <field>
        <column_name>ONEE-BE nb</column_name>
        <stream_name>ONEE-BE nb</stream_name>
      </field>
      <field>
        <column_name>ONEE-BE Amt Mad</column_name>
        <stream_name>ONEE-BE Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Comm_23</column_name>
        <stream_name>Comm_23</stream_name>
      </field>
      <field>
        <column_name>i-tr nb</column_name>
        <stream_name>i-tr nb</stream_name>
      </field>
      <field>
        <column_name>i-tr AMt MAd</column_name>
        <stream_name>i-tr AMt MAd</stream_name>
      </field>
      <field>
        <column_name>Montant Euro Recu_11</column_name>
        <stream_name>Montant Euro Recu_11</stream_name>
      </field>
      <field>
        <column_name>Cours de cession _12</column_name>
        <stream_name>Cours de cession _12</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs _11</column_name>
        <stream_name>Contre valeur En DHs _11</stream_name>
      </field>
      <field>
        <column_name>Comm_24</column_name>
        <stream_name>Comm_24</stream_name>
      </field>
      <field>
        <column_name>RADEETA nb</column_name>
        <stream_name>RADEETA nb</stream_name>
      </field>
      <field>
        <column_name>RADEETA Amt Mad</column_name>
        <stream_name>RADEETA Amt Mad</stream_name>
      </field>
      <field>
        <column_name>RADEEL nb</column_name>
        <stream_name>RADEEL nb</stream_name>
      </field>
      <field>
        <column_name>RADEEL Amt Mad</column_name>
        <stream_name>RADEEL Amt Mad</stream_name>
      </field>
      <field>
        <column_name>AIR ARABIA nb</column_name>
        <stream_name>AIR ARABIA nb</stream_name>
      </field>
      <field>
        <column_name>AIR ARABIA Amt Mad</column_name>
        <stream_name>AIR ARABIA Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Orange Facture nb</column_name>
        <stream_name>Orange Facture nb</stream_name>
      </field>
      <field>
        <column_name>Orange Facture Amt Mad</column_name>
        <stream_name>Orange Facture Amt Mad</stream_name>
      </field>
      <field>
        <column_name>ANCFCC nb</column_name>
        <stream_name>ANCFCC nb</stream_name>
      </field>
      <field>
        <column_name>ANCFCC Amt Mad</column_name>
        <stream_name>ANCFCC Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Cours de cession_0</column_name>
        <stream_name>Cours de cession </stream_name>
      </field>
      <field>
        <column_name>Cours de cession_00</column_name>
        <stream_name>Cours de cession_1</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs_0</column_name>
        <stream_name>Contre valeur En DHs</stream_name>
      </field>
      <field>
        <column_name>AMN Tetouan Amt Mad</column_name>
        <stream_name> AMN Tetouan Amt Mad</stream_name>
      </field>
      <field>
        <column_name>AMN Tanger Amt Mad</column_name>
        <stream_name> AMN Tanger Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Cours de cession </column_name>
        <stream_name>Cours de cession </stream_name>
      </field>
      <field>
        <column_name>Cours de cession_1</column_name>
        <stream_name>Cours de cession_1</stream_name>
      </field>
      <field>
        <column_name>Contre valeur En DHs</column_name>
        <stream_name>Contre valeur En DHs</stream_name>
      </field>
      <field>
        <column_name> AMN Tetouan Amt Mad</column_name>
        <stream_name> AMN Tetouan Amt Mad</stream_name>
      </field>
      <field>
        <column_name> AMN Tanger Amt Mad</column_name>
        <stream_name> AMN Tanger Amt Mad</stream_name>
      </field>
      <field>
        <column_name>E-Timbre nb</column_name>
        <stream_name>E-Timbre nb</stream_name>
      </field>
      <field>
        <column_name>E-Timbre Amt Mad</column_name>
        <stream_name>E-Timbre Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Maroc Télécom  nb</column_name>
        <stream_name>Maroc Télécom  nb</stream_name>
      </field>
      <field>
        <column_name>Maroc Télécom Amt Mad</column_name>
        <stream_name>Maroc Télécom Amt Mad</stream_name>
      </field>
      <field>
        <column_name>Full_date</column_name>
        <stream_name>full_Date</stream_name>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
